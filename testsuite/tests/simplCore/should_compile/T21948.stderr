
==================== Tidy Core ====================
Result size of Tidy Core
  = {terms: 59, types: 65, coercions: 21, joins: 1/3}

-- RHS size: {terms: 42, types: 34, coercions: 0, joins: 1/3}
T21948.nf'1
  :: forall b a.
     (b -> ())
     -> (a -> b)
     -> a
     -> Int64
     -> GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld
     -> (# GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld, () #)
[GblId,
 Arity=5,
 Str=<MC(1,A)><MC(1,L)><L><1!P(L)><L>,
 Cpr=1(, 1),
 Unf=Unf{Src=StableSystem, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=5,unsat_ok=True,boring_ok=False)
         Tmpl= \ (@b_a11C)
                 (@a_a11D)
                 (reduce_aEv [Occ=OnceL1!] :: b_a11C -> ())
                 (f_aEw [Occ=Once1!] :: a_a11D -> b_a11C)
                 (x_aEx [Occ=Once1] :: a_a11D)
                 (eta_B0 [Occ=Once1] :: Int64)
                 (eta1_B1 [Occ=Once1, OS=OneShot]
                    :: GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld) ->
                 let {
                   lvl_s171 [Occ=OnceL1] :: b_a11C
                   [LclId]
                   lvl_s171 = f_aEw x_aEx } in
                 joinrec {
                   go_s16Z [InlPrag=[2], Occ=T[2], Dmd=LC(S,C(1,!P(L,L)))]
                     :: Int64
                        -> GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld
                        -> (# GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld, () #)
                   [LclId[JoinId(2)(Just [!])],
                    Arity=2,
                    Str=<S!P(L)><L>,
                    Unf=Unf{Src=StableSystem, TopLvl=False,
                            Value=True, ConLike=True, WorkFree=True, Expandable=True,
                            Guidance=ALWAYS_IF(arity=2,unsat_ok=True,boring_ok=False)
                            Tmpl= \ (n_s17e [Occ=Once1!] :: Int64)
                                    (eta2_s17i [Occ=Once1, OS=OneShot]
                                       :: GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld) ->
                                    case n_s17e of { GHC.Internal.Int.I64# ww_s17g [Occ=Once1] ->
                                    jump $wgo_s17j ww_s17g eta2_s17i
                                    }}]
                   go_s16Z (n_s17e [Occ=Once1!] :: Int64)
                           (eta2_s17i [Occ=Once1, OS=OneShot]
                              :: GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld)
                     = case n_s17e of { GHC.Internal.Int.I64# ww_s17g [Occ=Once1] ->
                       jump $wgo_s17j ww_s17g eta2_s17i
                       };
                   $wgo_s17j [InlPrag=[2], Occ=LoopBreakerT[2]]
                     :: GHC.Internal.Prim.Int64#
                        -> GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld
                        -> (# GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld, () #)
                   [LclId[JoinId(2)(Nothing)], Arity=2, Str=<L><L>, Unf=OtherCon []]
                   $wgo_s17j (ww_s17g :: GHC.Internal.Prim.Int64#)
                             (eta2_s17i [Occ=Once2, OS=OneShot]
                                :: GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld)
                     = case GHC.Internal.Prim.leInt64# ww_s17g 0#Int64 of {
                         __DEFAULT ->
                           case lvl_s171 of y_aRh [Occ=Once1] { __DEFAULT ->
                           case reduce_aEv y_aRh of { () ->
                           jump go_s16Z
                             (GHC.Internal.Int.I64#
                                (GHC.Internal.Prim.subInt64# ww_s17g 1#Int64))
                             eta2_s17i
                           }
                           };
                         1# -> (# eta2_s17i, GHC.Internal.Tuple.() #)
                       }; } in
                 jump go_s16Z eta_B0 eta1_B1}]
T21948.nf'1
  = \ (@b_a11C)
      (@a_a11D)
      (reduce_aEv :: b_a11C -> ())
      (f_aEw [OS=OneShot] :: a_a11D -> b_a11C)
      (x_aEx [OS=OneShot] :: a_a11D)
      (eta_B0 [OS=OneShot] :: Int64)
      (eta1_B1 [OS=OneShot]
         :: GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld) ->
      case eta_B0 of { GHC.Internal.Int.I64# ww_s17g ->
      let {
        lvl_s171 :: b_a11C
        [LclId]
        lvl_s171 = f_aEw x_aEx } in
      let {
        lvl1_s17C [Dmd=LA] :: ()
        [LclId]
        lvl1_s17C = reduce_aEv lvl_s171 } in
      joinrec {
        $wgo_s17j [InlPrag=[2], Occ=LoopBreaker, Dmd=SC(S,C(1,!P(L,L)))]
          :: GHC.Internal.Prim.Int64#
             -> GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld
             -> (# GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld, () #)
        [LclId[JoinId(2)(Nothing)], Arity=2, Str=<L><L>, Unf=OtherCon []]
        $wgo_s17j (ww1_X3 :: GHC.Internal.Prim.Int64#)
                  (eta2_s17i [OS=OneShot]
                     :: GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld)
          = case GHC.Internal.Prim.leInt64# ww1_X3 0#Int64 of {
              __DEFAULT ->
                case lvl_s171 of { __DEFAULT ->
                case lvl1_s17C of { () ->
                jump $wgo_s17j
                  (GHC.Internal.Prim.subInt64# ww1_X3 1#Int64) eta2_s17i
                }
                };
              1# -> (# eta2_s17i, GHC.Internal.Tuple.() #)
            }; } in
      jump $wgo_s17j ww_s17g eta1_B1
      }

-- RHS size: {terms: 1, types: 0, coercions: 21, joins: 0/0}
nf' :: forall b a. (b -> ()) -> (a -> b) -> a -> Int64 -> IO ()
[GblId,
 Arity=5,
 Str=<MC(1,A)><MC(1,L)><L><1!P(L)><L>,
 Cpr=1(, 1),
 Unf=Unf{Src=<vanilla>, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)}]
nf'
  = T21948.nf'1
    `cast` (forall (b :: <*>_N) (a :: <*>_N).
            <b -> ()>_R
            ->_R <a -> b>_R
            ->_R <a>_R
            ->_R <Int64>_R
            ->_R Sym (GHC.Internal.Types.N:IO <()>_R)
            :: (forall b a.
                (b -> ())
                -> (a -> b)
                -> a
                -> Int64
                -> GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld
                -> (# GHC.Internal.Prim.State# GHC.Internal.Prim.RealWorld, () #))
               ~R# (forall b a. (b -> ()) -> (a -> b) -> a -> Int64 -> IO ()))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
T21948.$trModule4 :: GHC.Internal.Prim.Addr#
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [] 20 0}]
T21948.$trModule4 = "main"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
T21948.$trModule3 :: GHC.Internal.Types.TrName
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [] 10 10}]
T21948.$trModule3 = GHC.Internal.Types.TrNameS T21948.$trModule4

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
T21948.$trModule2 :: GHC.Internal.Prim.Addr#
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [] 30 0}]
T21948.$trModule2 = "T21948"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
T21948.$trModule1 :: GHC.Internal.Types.TrName
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [] 10 10}]
T21948.$trModule1 = GHC.Internal.Types.TrNameS T21948.$trModule2

-- RHS size: {terms: 3, types: 0, coercions: 0, joins: 0/0}
T21948.$trModule :: GHC.Internal.Types.Module
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True,
         Value=True, ConLike=True, WorkFree=True, Expandable=True,
         Guidance=IF_ARGS [] 10 10}]
T21948.$trModule
  = GHC.Internal.Types.Module T21948.$trModule3 T21948.$trModule1



